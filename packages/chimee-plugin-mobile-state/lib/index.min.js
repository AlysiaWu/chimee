!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("chimee"),require("chimee-plugin-gesture")):"function"==typeof define&&define.amd?define(["chimee","chimee-plugin-gesture"],e):(t=t||self).ChimeePluginMobileState=e(t.Chimee,t.ChimeePluginGesture)}(this,function(t,d){"use strict";function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}d=d&&d.hasOwnProperty("default")?d.default:d;var v=n(function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}}});e(v);var r=n(function(t,e){e.__esModule=!0,e.default=function(t,e){return t.classList?!!e&&t.classList.contains(e):-1!==(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+e+" ")},t.exports=e.default});e(r);var s=n(function(t,e){e.__esModule=!0,e.default=function(t,e){t.classList?t.classList.add(e):(0,n.default)(t,e)||("string"==typeof t.className?t.className=t.className+" "+e:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+e))};var n=v(r);t.exports=e.default});function a(t,e){return t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}e(s);var f=function(t,e){t.classList?t.classList.remove(e):"string"==typeof t.className?t.className=a(t.className,e):t.setAttribute("class",a(t.className&&t.className.baseVal||"",e))},o=n(function(t,e){e.__esModule=!0,e.default=void 0;var n=v(s);e.addClass=n.default;var a=v(f);e.removeClass=a.default;var o=v(r);e.hasClass=o.default;var i={addClass:n.default,removeClass:a.default,hasClass:o.default};e.default=i});e(o);var i=o.addClass,l=o.removeClass,g=(o.hasClass,n(function(t,e){e.__esModule=!0,e.default=void 0;var n=!("undefined"==typeof window||!window.document||!window.document.createElement);e.default=n,t.exports=e.default}));e(g);var m=n(function(t,e){e.__esModule=!0,e.default=function(t,e){var n,a="#"===e[0],o="."===e[0],i=a||o?e.slice(1):e;if(r.test(i))return a?(t=t.getElementById?t:document,(n=t.getElementById(i))?[n]:[]):t.getElementsByClassName&&o?s(t.getElementsByClassName(i)):s(t.getElementsByTagName(e));return s(t.querySelectorAll(e))};var r=/^[\w-]*$/,s=Function.prototype.bind.call(Function.prototype.call,[].slice);t.exports=e.default});e(m);var h=n(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!o&&i.default){var n=document.body,a=n.matches||n.matchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector;o=a?function(t,e){return a.call(t,e)}:s}return o?o(t,e):null};var o,i=v(g),r=v(m);function s(t,e){for(var n=(0,r.default)(t.document||t.ownerDocument,e),a=0;n[a]&&n[a]!==t;)a++;return!!n[a]}t.exports=e.default});e(h);var y=n(function(t,e){e.__esModule=!0,e.default=void 0;var n=v(g).default?function(t,e){return t.contains?t.contains(e):t.compareDocumentPosition?t===e||!!(16&t.compareDocumentPosition(e)):a(t,e)}:a;function a(t,e){if(e)do{if(e===t)return!0}while(e=e.parentNode);return!1}e.default=n,t.exports=e.default});e(y);var u=n(function(t,e){e.__esModule=!0,e.default=function(t){return t===t.window?t:9===t.nodeType&&(t.defaultView||t.parentWindow)},t.exports=e.default});e(u);var c=n(function(t,e){e.__esModule=!0,e.default=function(t){return t&&t.ownerDocument||document},t.exports=e.default});e(c);var w=n(function(t,e){e.__esModule=!0,e.default=function(t){var e=(0,s.default)(t),n=(0,r.default)(e),a=e&&e.documentElement,o={top:0,left:0,height:0,width:0};if(!e)return;if(!(0,i.default)(a,t))return o;void 0!==t.getBoundingClientRect&&(o=t.getBoundingClientRect());return o={top:o.top+(n.pageYOffset||a.scrollTop)-(a.clientTop||0),left:o.left+(n.pageXOffset||a.scrollLeft)-(a.clientLeft||0),width:(null==o.width?t.offsetWidth:o.width)||0,height:(null==o.height?t.offsetHeight:o.height)||0}};var i=v(y),r=v(u),s=v(c);t.exports=e.default});e(w);var x=n(function(t,e){e.__esModule=!0,e.default=function(t,e){var n=(0,o.default)(t);return n?n.innerHeight:e?t.clientHeight:(0,a.default)(t).height};var a=v(w),o=v(u);t.exports=e.default});e(x);var _=n(function(t,e){e.__esModule=!0,e.default=function(t,e){var n=(0,o.default)(t);return n?n.innerWidth:e?t.clientWidth:(0,a.default)(t).width};var a=v(w),o=v(u);t.exports=e.default});e(_);var p=n(function(t,e){e.__esModule=!0,e.default=function(t){return t.replace(n,function(t,e){return e.toUpperCase()})};var n=/-(.)/g;t.exports=e.default});e(p);var b=n(function(t,e){e.__esModule=!0,e.default=function(t){return(0,n.default)(t.replace(a,"ms-"))};var n=v(p),a=/^-ms-/;t.exports=e.default});e(b);var T=n(function(t,e){e.__esModule=!0,e.default=function(t){return t.replace(n,"-$1").toLowerCase()};var n=/([A-Z])/g;t.exports=e.default});e(T);var N=n(function(t,e){e.__esModule=!0,e.default=function(t){return(0,n.default)(t).replace(a,"-ms-")};var n=v(T),a=/^ms-/;t.exports=e.default});e(N);var C=n(function(t,e){e.__esModule=!0,e.default=function(r){if(!r)throw new TypeError("No Element passed to `getComputedStyle()`");var t=r.ownerDocument;return"defaultView"in t?t.defaultView.opener?r.ownerDocument.defaultView.getComputedStyle(r,null):window.getComputedStyle(r,null):{getPropertyValue:function(t){var e=r.style;"float"==(t=(0,s.default)(t))&&(t="styleFloat");var n=r.currentStyle[t]||null;if(null==n&&e&&e[t]&&(n=e[t]),l.test(n)&&!f.test(t)){var a=e.left,o=r.runtimeStyle,i=o&&o.left;i&&(o.left=r.currentStyle.left),e.left="fontSize"===t?"1em":n,n=e.pixelLeft+"px",e.left=a,i&&(o.left=i)}return n}}};var s=v(b),f=/^(top|right|bottom|left)$/,l=/^([+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|))(?!px)[a-z%]+$/i;t.exports=e.default});e(C);var P=n(function(t,e){e.__esModule=!0,e.default=function(t,e){return"removeProperty"in t.style?t.style.removeProperty(e):t.style.removeAttribute(e)},t.exports=e.default});e(P);var M=n(function(t,e){e.__esModule=!0,e.default=e.animationEnd=e.animationDelay=e.animationTiming=e.animationDuration=e.animationName=e.transitionEnd=e.transitionDuration=e.transitionDelay=e.transitionTiming=e.transitionProperty=e.transform=void 0;var n,a,o,i,r,s,f,l,u,d,c,p=v(g),m="transform";if(e.transform=m,e.animationEnd=o,e.transitionEnd=a,e.transitionDelay=f,e.transitionTiming=s,e.transitionDuration=r,e.transitionProperty=i,e.animationDelay=c,e.animationTiming=d,e.animationDuration=u,e.animationName=l,p.default){var h=function(){for(var t,e,n=document.createElement("div").style,a={O:function(t){return"o"+t.toLowerCase()},Moz:function(t){return t.toLowerCase()},Webkit:function(t){return"webkit"+t},ms:function(t){return"MS"+t}},o=Object.keys(a),i="",r=0;r<o.length;r++){var s=o[r];if(s+"TransitionProperty"in n){i="-"+s.toLowerCase(),t=a[s]("TransitionEnd"),e=a[s]("AnimationEnd");break}}!t&&"transitionProperty"in n&&(t="transitionend");!e&&"animationName"in n&&(e="animationend");return n=null,{animationEnd:e,transitionEnd:t,prefix:i}}();n=h.prefix,e.transitionEnd=a=h.transitionEnd,e.animationEnd=o=h.animationEnd,e.transform=m=n+"-"+m,e.transitionProperty=i=n+"-transition-property",e.transitionDuration=r=n+"-transition-duration",e.transitionDelay=f=n+"-transition-delay",e.transitionTiming=s=n+"-transition-timing-function",e.animationName=l=n+"-animation-name",e.animationDuration=u=n+"-animation-duration",e.animationTiming=d=n+"-animation-delay",e.animationDelay=c=n+"-animation-timing-function"}var y={transform:m,end:a,property:i,timing:s,delay:f,duration:r};e.default=y});e(M);M.animationEnd,M.animationDelay,M.animationTiming,M.animationDuration,M.animationName,M.transitionEnd,M.transitionDuration,M.transitionDelay,M.transitionTiming,M.transitionProperty,M.transform;var S=n(function(t,e){e.__esModule=!0,e.default=function(t){return!(!t||!n.test(t))};var n=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;t.exports=e.default});e(S);var E=n(function(t,e){e.__esModule=!0,e.default=function(n,t,e){var a="",o="",i=t;if("string"==typeof t){if(void 0===e)return n.style[(0,r.default)(t)]||(0,f.default)(n).getPropertyValue((0,s.default)(t));(i={})[t]=e}Object.keys(i).forEach(function(t){var e=i[t];e||0===e?(0,u.default)(t)?o+=t+"("+e+") ":a+=(0,s.default)(t)+": "+e+";":(0,l.default)(n,(0,s.default)(t))}),o&&(a+=M.transform+": "+o+";");n.style.cssText+=";"+a};var r=v(b),s=v(N),f=v(C),l=v(P),u=v(S);t.exports=e.default});e(E);var O=n(function(t,e){e.__esModule=!0,e.default=function(t){var e=(0,o.default)(t),n=t&&t.offsetParent;for(;n&&"html"!==(a=t,a.nodeName&&a.nodeName.toLowerCase())&&"static"===(0,i.default)(n,"position");)n=n.offsetParent;var a;return n||e.documentElement};var o=v(c),i=v(E);t.exports=e.default});e(O);var D=n(function(t){function e(){return t.exports=e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},e.apply(this,arguments)}t.exports=e}),L=n(function(t,e){e.__esModule=!0,e.default=function(t,e){var n=(0,a.default)(t);if(void 0===e)return n?"pageYOffset"in n?n.pageYOffset:n.document.documentElement.scrollTop:t.scrollTop;n?n.scrollTo("pageXOffset"in n?n.pageXOffset:n.document.documentElement.scrollLeft,e):t.scrollTop=e};var a=v(u);t.exports=e.default});e(L);var k=n(function(t,e){e.__esModule=!0,e.default=function(t,e){var n=(0,a.default)(t);if(void 0===e)return n?"pageXOffset"in n?n.pageXOffset:n.document.documentElement.scrollLeft:t.scrollLeft;n?n.scrollTo(e,"pageYOffset"in n?n.pageYOffset:n.document.documentElement.scrollTop):t.scrollLeft=e};var a=v(u);t.exports=e.default});e(k);var A=n(function(t,e){e.__esModule=!0,e.default=function(t,e){var n,a={top:0,left:0};"fixed"===(0,u.default)(t,"position")?n=t.getBoundingClientRect():(e=e||(0,s.default)(t),n=(0,r.default)(t),"html"!==((o=e).nodeName&&o.nodeName.toLowerCase())&&(a=(0,r.default)(e)),a.top+=parseInt((0,u.default)(e,"borderTopWidth"),10)-(0,f.default)(e)||0,a.left+=parseInt((0,u.default)(e,"borderLeftWidth"),10)-(0,l.default)(e)||0);var o;return(0,i.default)({},n,{top:n.top-a.top-(parseInt((0,u.default)(t,"marginTop"),10)||0),left:n.left-a.left-(parseInt((0,u.default)(t,"marginLeft"),10)||0)})};var i=v(D),r=v(w),s=v(O),f=v(L),l=v(k),u=v(E);t.exports=e.default});e(A);var $=n(function(t,e){e.__esModule=!0,e.default=function(t){var e=(0,r.default)(t,"position"),n="absolute"===e,a=t.ownerDocument;if("fixed"===e)return a||document;for(;(t=t.parentNode)&&9!==t.nodeType;){var o=n&&"static"===(0,r.default)(t,"position"),i=(0,r.default)(t,"overflow")+(0,r.default)(t,"overflow-y")+(0,r.default)(t,"overflow-x");if(!o&&(/(auto|scroll)/.test(i)&&(0,s.default)(t)<t.scrollHeight))return t}return document};var r=v(E),s=v(x);t.exports=e.default});e($);var j=n(function(t,e){e.__esModule=!0,e.default=function(t,e,n){for(;t&&(o(t)||!(0,a.default)(t,e));)t=t===n||o(t)?void 0:t.parentNode;return t};var a=v(h),o=function(t){return null!=t&&t.nodeType===t.DOCUMENT_NODE};t.exports=e.default});e(j);var B=n(function(t,e){e.__esModule=!0,e.default=void 0;var n=v(h);e.matches=n.default;var a=v(x);e.height=a.default;var o=v(_);e.width=o.default;var i=v(w);e.offset=i.default;var r=v(O);e.offsetParent=r.default;var s=v(A);e.position=s.default;var f=v(y);e.contains=f.default;var l=v($);e.scrollParent=l.default;var u=v(L);e.scrollTop=u.default;var d=v(m);e.querySelectorAll=d.default;var c=v(j);e.closest=c.default;var p={matches:n.default,height:a.default,width:o.default,offset:i.default,offsetParent:r.default,position:s.default,contains:f.default,scrollParent:l.default,scrollTop:u.default,querySelectorAll:d.default,closest:c.default};e.default=p});e(B);B.matches,B.height,B.width,B.offset,B.offsetParent,B.position,B.contains,B.scrollParent,B.scrollTop;var F,V=B.querySelectorAll,W=(B.closest,F=function(t,e){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}F(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});return function(u){function t(t,e,n){var a=u.call(this,Object.assign(t,{dependencies:n.customGesture?[]:[d.name],el:'\n<chimee-state class="play">\n  <chimee-state-loading></chimee-state-loading>\n  <chimee-state-play></chimee-state-play>\n  <chimee-state-error></chimee-state-error>\n</chimee-state>\n',operable:!1,penetrate:!0}),e,n)||this,o=n.expectTime,i=void 0===o?3e4:o,r=n.errorTips,s=void 0===r?"加载失败，请刷新重试":r,f=n.icon,l=void 0===f?{}:f;return a.errorTips=s,a.expectTime=i,a.icon=Object.assign({loading:"<svg width='120px' height='120px' xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"xMidYMid\" class=\"uil-default\"><rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" fill=\"none\" class=\"bk\"></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(0 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-1s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(30 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.9166666666666666s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(60 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.8333333333333334s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(90 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.75s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(120 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.6666666666666666s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(150 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.5833333333333334s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(180 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.5s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(210 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.4166666666666667s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(240 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.3333333333333333s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(270 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.25s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(300 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.16666666666666666s' repeatCount='indefinite'/></rect><rect  x='47' y='40' width='6' height='20' rx='5' ry='5' fill='#ffffff' transform='rotate(330 50 50) translate(0 -30)'>  <animate attributeName='opacity' from='1' to='0' dur='1s' begin='-0.08333333333333333s' repeatCount='indefinite'/></rect></svg>",play:'\n<svg width="92px" height="92px" viewBox="0 0 92 92" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 47.1 (45422) - http://www.bohemiancoding.com/sketch --\x3e\n    <desc>Created with Sketch.</desc>\n    <defs></defs>\n    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <circle id="Oval" fill-opacity="0.5" fill="#000000" cx="46" cy="46" r="46"></circle>\n        <polygon id="Triangle" fill="#FFFFFF" transform="translate(51.000000, 46.500000) rotate(90.000000) translate(-51.000000, -46.500000) " points="51 26 76 67 26 67"></polygon>\n    </g>\n</svg>'},l),a.currentState="",a.isShown=!1,a}return W(t,u),t.prototype.create=function(){this.on("load",this.onLoad),this.on("panend",this.onPanend),this.on("panmove",this.onPanmove),this.on("panstart",this.onPanstart),this.on("pause",this.onPause),this.on("play",this.onPlay),this.on("playing",this.onPlaying),this.on("seeked",this.onSeeked),this.on("seeking",this.onSeeking),this.on("tap",this.onTap),this.on("timeupdate",this.onTimeupdate),this.on("waiting",this.onWaiting)},t.prototype.inited=function(){this.addInnerHtml(),!this.src||"auto"!==this.preload&&"metadata"!==this.preload&&""!==this.preload&&!0!==this.autoplay||this.showState("loading",!0)},t.prototype.addInnerHtml=function(){var n=this;["play","loading","error"].forEach(function(t){var e=V(n.$dom,"chimee-state-"+t);e.length&&e[0]&&(e[0].innerHTML="error"===t?n.errorTips:n.icon[t])})},t.prototype.clearTimeout=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t.prototype.onLoad=function(){this.showState("play",!0)},t.prototype.onPanend=function(t){this.emitSync("state-panend",t)},t.prototype.onPanmove=function(t){this.emitSync("state-panmove",t)},t.prototype.onPanstart=function(t){this.emitSync("state-panstart",t)},t.prototype.onPause=function(){this.showState("play",!0)},t.prototype.onPlay=function(){this.showState("",!1)},t.prototype.onPlaying=function(){this.playing()},t.prototype.onSeeked=function(){this.playing()},t.prototype.onSeeking=function(){this.waiting()},t.prototype.onTap=function(t){this.emitSync("state-tap",t)},t.prototype.onTimeupdate=function(){this.clearTimeout()},t.prototype.onWaiting=function(){this.waiting()},t.prototype.playing=function(){this.clearTimeout(),this.showState("",!1)},t.prototype.showState=function(e,n){var a=this;this.currentState=e,(this.isShown=n)&&this.emitSync("state-change",e),["loading","error","play"].forEach(function(t){t===e&&n?i(a.$dom,t):l(a.$dom,t)})},t.prototype.waiting=function(){var t=this;this.clearTimeout(),this.timeout=setTimeout(function(){return t.showState("error",!0)},this.expectTime),this.paused||this.showState("loading",!0)},t}(t.Plugin)});
